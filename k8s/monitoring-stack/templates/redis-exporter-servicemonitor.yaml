apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: redis-exporter-monitor
  namespace: monitoring  # Use the namespace where the exporter is running
  labels:
    app: prometheus  # Match the label that Prometheus is configured to select
    release: prometheus  # Ensure this label aligns with Prometheus's `serviceMonitorSelector`
spec:
  selector:
    matchLabels:
      app: redis-exporter  # Match this label with the label on the redis-exporter Service
  endpoints:
    - port: redis-exporter  # Name of the port in the redis-exporter service
      path: /metrics  # Path where metrics are exposed
      interval: 30s  # Scraping interval
  namespaceSelector:
    matchNames:
      - default  # Namespace where the Redis exporter is running
